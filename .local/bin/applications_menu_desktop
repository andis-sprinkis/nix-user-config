#!/usr/bin/env sh

application_menu="dmenu"
[ "$XDG_SESSION_TYPE" = "wayland" ] && application_menu="wmenu"

path_appimage="${APPIMAGE_BIN_HOME:-$HOME/.local/opt/appimage/}"
cmd_menu="(cat; stest -flx \"${path_appimage}\" | awk '{ print \"${path_appimage}\"\$0 }' | sort -u) | ${application_menu}"

exec j4-dmenu-desktop \
  --no-generic \
  --display-binary \
  --dmenu="$cmd_menu" \
  --usage-log="${XDG_CACHE_HOME:-HOME/.cache}/j4-dmenu-desktop/log"
