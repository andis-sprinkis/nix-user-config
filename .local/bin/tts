#!/usr/bin/env sh
set -eu

text=

while read -r ln || [ -n "$ln" ]; do 
  text="$text${ln}" 
done

echo "Input text:

${text}

--------
" | fmt -u --width="48"

echo "$text" | \
  piper \
    --output-raw \
    --model "${XDG_DATA_HOME:-$HOME/.local/share}/piper-voices/en/en_US/hfc_female/medium/en_US-hfc_female-medium.onnx" | \
      mpv \
        --demuxer=rawaudio \
        --demuxer-rawaudio-rate=22050 \
        --demuxer-rawaudio-channels=1 \
        --keep-open=yes \
        --keep-open-pause=yes \
        --loop-file=no \
        --loop-playlist=no \
        -
