#!/usr/bin/env sh
set -eu

json_output="$(i3-msg -t get_outputs | jq ".[] | select(.focused == true).rect")"
output_width="$(echo "$json_output" | jq ".width")"
output_height="$(echo "$json_output" | jq ".height")"

max_width="1920"
max_height="1280"
padding_percent="0.075"

padding="$(echo "(${padding_percent} * ${output_width} + ${padding_percent} * ${output_height}) / 2" | bc)"
width="$(echo "${output_width} - ${padding}" | bc)"
height="$(echo "${output_height} - ${padding}" | bc)"

if [ "$width" -gt "$max_width" ]; then
  width="$max_width"
fi

if [ "$height" -gt "$max_height" ]; then
  height="$max_height"
fi

i3-msg -q "floating toggle; resize set width ${width} height ${height}"
